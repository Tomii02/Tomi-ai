<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tomii - Dashboard</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    :root {
      --dark-blue: #0A1128;
      --medium-blue: #001F54;
      --accent-blue: #034078;
      --light-blue: #128fdc;
      --white: #F9F9F9;
      --green: #2ecc71;
      --orange: #e67e22;
    }
    
    body {
      margin: 0;
      font-family: 'Montserrat', sans-serif;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      color: var(--white);
      background-color: var(--dark-blue);
      position: relative;
      overflow: hidden;
      background-image: radial-gradient(circle, var(--medium-blue) 0%, transparent 80%),
                        radial-gradient(circle at 100% 100%, #17387e 0%, transparent 60%);
      animation: backgroundPan 30s linear infinite;
    }

    @keyframes backgroundPan {
      from { background-position: 0% 0%; }
      to { background-position: 100% 100%; }
    }

    /* Video Background */
    #bg-media-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -2;
      opacity: 0.3;
      filter: blur(5px);
    }

    #bg-media-container video, 
    #bg-media-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    
    .main-box {
      width: 380px;
      padding: 40px;
      border-radius: 25px;
      text-align: center;
      background: rgba(10, 17, 40, 0.6);
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow: 0 15px 45px rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      animation: fadeIn 1s ease-in-out;
      z-index: 1;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(30px) scale(0.95); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    .profile-img {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      border: 5px solid var(--light-blue);
      margin-bottom: 25px;
      object-fit: cover;
      box-shadow: 0 0 25px var(--light-blue);
      transition: transform 0.4s ease, box-shadow 0.4s ease;
    }
    
    .profile-img:hover {
      transform: scale(1.05) rotate(5deg);
      box-shadow: 0 0 40px var(--light-blue);
    }

    h1 {
        font-size: 2.2em;
        font-weight: 700;
        margin-bottom: 5px;
        color: var(--white);
        text-shadow: 0 0 10px var(--light-blue);
        letter-spacing: 1px;
    }
    
    h2 {
      margin-top: 0;
      margin-bottom: 35px;
      font-size: 2em;
      font-weight: 600;
      text-shadow: 0 0 8px var(--white);
    }
    
    input {
      width: calc(100% - 24px);
      padding: 16px 12px;
      margin-bottom: 25px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.1);
      color: var(--white);
      text-align: center;
      transition: all 0.3s ease;
      font-size: 16px;
      box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
    }
    
    input::placeholder {
      color: rgba(255, 255, 255, 0.7);
    }
    
    input:focus {
      outline: none;
      border-color: var(--light-blue);
      box-shadow: 0 0 15px var(--light-blue);
      background: rgba(255, 255, 255, 0.15);
    }

    .button-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }

    .button-full {
      grid-column: span 2;
    }

    button {
      padding: 18px;
      border: none;
      border-radius: 15px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 12px;
      font-size: 15px;
      text-transform: uppercase;
      opacity: 0.95;
      letter-spacing: 0.5px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }
    
    button:hover {
      transform: translateY(-5px);
      opacity: 1;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
    }

    /* Styles for different buttons */
    .wa { background: #25D366; color: #fff; }
    .wa:hover { background: #1eaa59; }

    .ai { background: var(--light-blue); color: #fff; }
    .ai:hover { background: #0c72b2; }

    .trap { background: #9b59b6; color: #fff; }
    .trap:hover { background: #8e44ad; }
    
    .shop-btn { background: #3498db; color: #fff; }
    .shop-btn:hover { background: #2980b9; }
    
    .generator-btn { background: #f39c12; color: #fff; }
    .generator-btn:hover { background: #e67e22; }
    
    .jurnal-btn { background: #e74c3c; color: #fff; }
    .jurnal-btn:hover { background: #c0392b; }
    
    .keuangan-btn { background: #27ae60; color: #fff; }
    .keuangan-btn:hover { background: #219d53; }

    .history-btn { background: #95a5a6; color: #fff; }
    .history-btn:hover { background: #7f8c8d; }
    
    .admin-btn { background: #e74c3c; color: #fff; }
    .admin-btn:hover { background: #c0392b; }

    .whatsapp-pairing { background: #075E54; color: #fff; }
    .whatsapp-pairing:hover { background: #054a42; }

    .watermark {
      position: absolute;
      bottom: 20px;
      left: 20px;
      color: rgba(255, 255, 255, 0.4);
      font-size: 14px;
      font-weight: 300;
      z-index: 1;
    }

    .admin-login-box {
      background: rgba(0, 0, 0, 0.4);
      padding: 25px;
      border-radius: 12px;
      margin-top: 25px;
      display: none;
      animation: fadeIn 0.5s ease-in-out;
    }
    
    .admin-login-box input {
      width: calc(100% - 24px);
    }
    
    .admin-login-box button {
      background: var(--light-blue);
      color: var(--white);
    }
    
    .admin-menu {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-top: 25px;
    }
  </style>
</head>
<body>
  
  <div id="bg-media-container">
    <video src="https://c.termai.cc/v27/vKp.mp4" autoplay loop muted playsinline></video>
  </div>

  <div class="main-box">
    <h1>Selamat Datang di Website Tomii</h1>
    <img src="https://c.termai.cc/i39/mLLz.jpg" alt="Tomii" class="profile-img" id="tomi-logo">
    <h2>Tomii</h2>
    <input id="nama" type="text" placeholder="Masukkan nama kamu">
    <div class="button-container">
      <button class="ai" onclick="gotoAI()">
        <i class="fas fa-robot"></i> Tanya AI
      </button>
      <button class="trap" onclick="gotoTrap()">
        <i class="fas fa-heart"></i> Buat Kamu
      </button>
      <button class="shop-btn" onclick="gotoTomiShop()">
        <i class="fas fa-shopping-cart"></i> TomiShop
      </button>
      <button class="jurnal-btn" onclick="gotoJurnal()">
        <i class="fas fa-chart-line"></i> Jurnal Transaksi
      </button>
      <button class="keuangan-btn" onclick="gotoKeuangan()">
        <i class="fas fa-file-invoice-dollar"></i> Laporan Keuangan
      </button>
      <button class="history-btn" onclick="gotoHistoryChat()">
        <i class="fas fa-history"></i> History Chat WA
      </button>
      <button class="generator-btn" onclick="gotoGenerator()">
        <i class="fas fa-file-code"></i> Buat Web
      </button>
      <button class="wa button-full" onclick="balikWA()">
        <i class="fab fa-whatsapp"></i> Tomii-Dev
      </button>
    </div>
    
    <div id="admin-login-form" class="admin-login-box">
        <input type="email" id="adminEmail" placeholder="Email Admin">
        <input type="password" id="adminPassword" placeholder="Kata Sandi Admin">
        <button onclick="loginAdmin()">
            <i class="fas fa-sign-in-alt"></i> Login
        </button>
    </div>
    
    <div id="admin-menu" class="admin-menu" style="display: none;">
      <button class="admin-btn" onclick="createVoucher()">
        <i class="fas fa-ticket-alt"></i> Buat Voucher
      </button>
      <button class="admin-btn" onclick="refillVoucher()">
        <i class="fas fa-redo-alt"></i> Isi Ulang Voucher
      </button>
    </div>
  </div>
  
  <div class="watermark">
    Developer: @Tomii
  </div>

  <script>
    function balikWA() {
      const nama = document.getElementById("nama").value.trim() || "Pengguna";
      const text = `Halo, nama saya ${nama}. Salam kenal.`;
      window.location.href = "https://wa.me/6285281555650?text=" + encodeURIComponent(text);
    }
    
    function gotoTrap() {
      const nama = document.getElementById("nama").value.trim() || "Sayang";
      localStorage.setItem('playMusic', 'true');
      window.location.href = `bucinweb.html?nama=${encodeURIComponent(nama)}`;
    }
    
    function gotoAI() {
      const nama = document.getElementById("nama").value.trim() || "Pengguna";
      window.location.href = "chat.html?nama=" + encodeURIComponent(nama);
    }
    
    function gotoJurnal() {
      const nama = document.getElementById("nama").value.trim() || "Pengguna";
      window.location.href = "jurnal.html?nama=" + encodeURIComponent(nama);
    }
    
    function gotoKeuangan() {
      const nama = document.getElementById("nama").value.trim() || "Pengguna";
      window.location.href = "jurnal2.html?nama=" + encodeURIComponent(nama);
    }
    
    function gotoHistoryChat() {
      window.location.href = "chat_viewer.html";
    }
    
    function gotoGenerator() {
      window.location.href = "generator.html";
    }
    
    function gotoTomiShop() {
      window.location.href = "TomiShop.html";
    }

    const API_URL = 'http://localhost:3000/api';
    
    const bellaLogo = document.getElementById('tomi-logo');
    let clickCount = 0;
    let clickTimeout;

    bellaLogo.addEventListener('click', () => {
        clickCount++;
        clearTimeout(clickTimeout);
        clickTimeout = setTimeout(() => {
            clickCount = 0;
        }, 1000);

        if (clickCount === 5) {
            document.getElementById('admin-login-form').style.display = 'block';
            alert("Silakan masukkan email dan kata sandi admin.");
            clickCount = 0;
        }
    });

    const adminEmailInput = document.getElementById('adminEmail');
    const adminPasswordInput = document.getElementById('adminPassword');

    function allowTextDeletion(event) {
        if (event.key === 'Backspace' || event.key === 'Delete') {
            return true;
        }
    }

    if (adminEmailInput) {
        adminEmailInput.addEventListener('keydown', allowTextDeletion);
    }
    if (adminPasswordInput) {
        adminPasswordInput.addEventListener('keydown', allowTextDeletion);
    }

    async function loginAdmin() {
        const email = document.getElementById('adminEmail').value;
        const password = document.getElementById('adminPassword').value;

        if (!email || !password) {
            alert('Email dan kata sandi harus diisi.');
            return;
        }

        try {
            const response = await fetch(`${API_URL}/auth/login`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password })
            });

            const data = await response.json();
            if (data.status) {
                localStorage.setItem('token', data.token);
                alert('Login Admin Berhasil!');
                checkAdminStatus();
                document.getElementById('admin-login-form').style.display = 'none';
            } else {
                alert('Login Gagal: ' + data.message);
            }
        } catch (error) {
            console.error('Login error:', error);
            alert('Terjadi kesalahan saat login.');
        }
    }

    async function checkAdminStatus() {
        const token = localStorage.getItem('token');
        if (!token) {
            console.log('Tidak ada token, menu admin tidak ditampilkan.');
            return;
        }

        try {
            const response = await fetch(`${API_URL}/auth/admin-status`, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}` 
                }
            });
            
            const data = await response.json();

            if (data.isAdmin) {
                const adminMenu = document.getElementById('admin-menu');
                if (adminMenu) {
                    adminMenu.style.display = 'grid';
                    console.log('Pengguna adalah admin, menu rahasia ditampilkan.');
                }
            } else {
                console.log('Pengguna bukan admin atau token tidak valid.');
                localStorage.removeItem('token');
            }
        } catch (error) {
            console.error('Gagal memvalidasi token:', error);
            localStorage.removeItem('token');
        }
    }

    document.addEventListener('DOMContentLoaded', checkAdminStatus);
    
    // Add WhatsApp pairing button
    document.addEventListener('DOMContentLoaded', function() {
        const buttonContainer = document.querySelector('.button-container');
        if (buttonContainer) {
            const whatsappPairingButton = document.createElement('button');
            whatsappPairingButton.className = 'whatsapp-pairing button-full';
            whatsappPairingButton.onclick = function() {
                window.location.href = 'whatsapp.html';
            };
            whatsappPairingButton.innerHTML = '<i class="fab fa-whatsapp"></i> Pairing WhatsApp Bot';
            buttonContainer.appendChild(whatsappPairingButton);
        }
    });

    function createVoucher() {
      const code = prompt("Masukkan kode voucher:");
      const type = prompt("Masukkan tipe (domain/service):");
      const value = prompt("Masukkan nilai diskon (angka):");
      
      if (code && type && value) {
        alert(`Membuat voucher:\nKode: ${code}\nTipe: ${type}\nNilai: Rp${value}`);
      }
    }

    function refillVoucher() {
      const code = prompt("Masukkan kode voucher yang akan diisi ulang:");
      if (code) {
        alert(`Mengisi ulang voucher:\nKode: ${code}`);
      }
    }
  </script>
</body>
</html>

